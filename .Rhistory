i<-1
penalty<-NULL
while(i <= length(data$income)){
income<-data$income[i]
stateincometax<-0
married<-0
income1<-income*multiplier
income2<-income*(1-multiplier)
taxburden1<-function(income1,children,married,hoh,stateincometax){
income<-income1
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
taxburden2<-function(income2,children,married,hoh,stateincometax){
income<-income2
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
marriedtaxburden<-function(income,children,married,hoh,stateincometax){
income<-income
married<-1
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
person1<-taxburden1(income1,children,married,hoh,stateincometax)
person2<-taxburden2(income2,children,married,hoh,stateincometax)
couple<-marriedtaxburden(income,children,married,hoh,stateincometax)
penalty[i]<-couple-(person1+person2)
i<-i+1
}
mat<-cbind(mat,penalty)
x<-x+1
}
write.table(mat,sep=",",file="marriagepenalty.txt")
View(mat)
t(output)
t(mat)
mat<-t(mat)
View(mat)
setwd("C:/Users/kep/Documents/GitHub/Marriage-Pen")
rm(list=ls())
#This spreadsheet has all the income data and will show all the calculations, step-by-step.
income<-read.csv("income.csv", header = TRUE, fill = TRUE, sep = ",")
statetax<-read.csv("statetaxdata.csv", header = TRUE, fill = TRUE, sep = ",")
fedtax<-read.csv("fedtax.csv", header = TRUE, fill = TRUE, sep = ",")
data<-read.csv("data.csv", header = TRUE, fill = TRUE, sep = ",")
#Load Functions
source("Functions.R")
children<-0
hoh<-0
mat<-data$income
x<-1
while(x <= length(data$income)){
multiplier<-data$multiplier[x]
i<-1
penalty<-NULL
while(i <= length(data$income)){
income<-data$income[i]
stateincometax<-0
married<-0
income1<-income*multiplier
income2<-income*(1-multiplier)
taxburden1<-function(income1,children,married,hoh,stateincometax){
income<-income1
children<-1
hoh<-1
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
taxburden2<-function(income2,children,married,hoh,stateincometax){
income<-income2
children<-0
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
marriedtaxburden<-function(income,children,married,hoh,stateincometax){
income<-income
married<-1
children<-1
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
person1<-taxburden1(income1,children,married,hoh,stateincometax)
person2<-taxburden2(income2,children,married,hoh,stateincometax)
couple<-marriedtaxburden(income,children,married,hoh,stateincometax)
penalty[i]<-couple-(person1+person2)
i<-i+1
}
output<-cbind(mat,penalty)
x<-x+1
}
t(output)
write.table(output,sep=",",file="marriagepenalty.txt")
View(output)
setwd("C:/Users/kep/Documents/GitHub/Marriage-Pen")
rm(list=ls())
#This spreadsheet has all the income data and will show all the calculations, step-by-step.
income<-read.csv("income.csv", header = TRUE, fill = TRUE, sep = ",")
statetax<-read.csv("statetaxdata.csv", header = TRUE, fill = TRUE, sep = ",")
fedtax<-read.csv("fedtax.csv", header = TRUE, fill = TRUE, sep = ",")
data<-read.csv("data.csv", header = TRUE, fill = TRUE, sep = ",")
#Load Functions
source("Functions.R")
children<-0
hoh<-0
mat<-data$income
x<-1
while(x <= length(data$income)){
multiplier<-data$multiplier[x]
i<-1
penalty<-NULL
while(i <= length(data$income)){
income<-data$income[i]
stateincometax<-0
married<-0
income1<-income*multiplier
income2<-income*(1-multiplier)
taxburden1<-function(income1,children,married,hoh,stateincometax){
income<-income1
children<-1
hoh<-1
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
taxburden2<-function(income2,children,married,hoh,stateincometax){
income<-income2
children<-0
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
marriedtaxburden<-function(income,children,married,hoh,stateincometax){
income<-income
married<-1
children<-1
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
person1<-taxburden1(income1,children,married,hoh,stateincometax)
person2<-taxburden2(income2,children,married,hoh,stateincometax)
couple<-marriedtaxburden(income,children,married,hoh,stateincometax)
penalty[i]<-couple-(person1+person2)
i<-i+1
}
output<-cbind(output,penalty)
x<-x+1
}
#t(output)
write.table(output,sep=",",file="marriagepenalty.txt")
setwd("C:/Users/kep/Documents/GitHub/Marriage-Pen")
rm(list=ls())
#This spreadsheet has all the income data and will show all the calculations, step-by-step.
income<-read.csv("income.csv", header = TRUE, fill = TRUE, sep = ",")
statetax<-read.csv("statetaxdata.csv", header = TRUE, fill = TRUE, sep = ",")
fedtax<-read.csv("fedtax.csv", header = TRUE, fill = TRUE, sep = ",")
data<-read.csv("data.csv", header = TRUE, fill = TRUE, sep = ",")
#Load Functions
source("Functions.R")
children<-0
hoh<-0
output<-data$income
x<-1
while(x <= length(data$income)){
multiplier<-data$multiplier[x]
i<-1
penalty<-NULL
while(i <= length(data$income)){
income<-data$income[i]
stateincometax<-0
married<-0
income1<-income*multiplier
income2<-income*(1-multiplier)
taxburden1<-function(income1,children,married,hoh,stateincometax){
income<-income1
children<-1
hoh<-1
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
taxburden2<-function(income2,children,married,hoh,stateincometax){
income<-income2
children<-0
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
marriedtaxburden<-function(income,children,married,hoh,stateincometax){
income<-income
married<-1
children<-1
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
person1<-taxburden1(income1,children,married,hoh,stateincometax)
person2<-taxburden2(income2,children,married,hoh,stateincometax)
couple<-marriedtaxburden(income,children,married,hoh,stateincometax)
penalty[i]<-couple-(person1+person2)
i<-i+1
}
output<-cbind(output,penalty)
x<-x+1
}
#t(output)
write.table(output,sep=",",file="marriagepenalty.txt")
View(output)
data2<-read.csv("data2.csv", header = TRUE, fill = TRUE, sep = ",")
data2<-read.csv("data2.csv", header = TRUE, fill = TRUE, sep = ",")
setwd("C:/Users/kep/Documents/GitHub/Marriage-Pen")
rm(list=ls())
#This spreadsheet has all the income data and will show all the calculations, step-by-step.
income<-read.csv("income.csv", header = TRUE, fill = TRUE, sep = ",")
statetax<-read.csv("statetaxdata.csv", header = TRUE, fill = TRUE, sep = ",")
fedtax<-read.csv("fedtax.csv", header = TRUE, fill = TRUE, sep = ",")
data<-read.csv("data.csv", header = TRUE, fill = TRUE, sep = ",")
data2<-read.csv("data2.csv", header = TRUE, fill = TRUE, sep = ",")
data2<-read.csv("newdata.csv", header = TRUE, fill = TRUE, sep = ",")
View(data2)
lm(formula = log(newdata$income) ~ newdata$multiplier)
lm(formula = log(data2$income) ~ data2$multiplier)
x<-data2$income
y<-data2$multiplier
lm(formula = x^2 ~ data2$multiplier)
lm(formula = 2^x ~ data2$multiplier)
lm(formula = 2^x ~ y)
lm(formula = x ~ y)
setwd("C:/Users/kep/Documents/GitHub/Marriage-Pen")
rm(list=ls())
#This spreadsheet has all the income data and will show all the calculations, step-by-step.
income<-read.csv("income.csv", header = TRUE, fill = TRUE, sep = ",")
statetax<-read.csv("statetaxdata.csv", header = TRUE, fill = TRUE, sep = ",")
fedtax<-read.csv("fedtax.csv", header = TRUE, fill = TRUE, sep = ",")
data<-read.csv("data.csv", header = TRUE, fill = TRUE, sep = ",")
data2<-read.csv("newdata.csv", header = TRUE, fill = TRUE, sep = ",")
View(data2)
View(data2)
setwd("C:/Users/kep/Documents/GitHub/Marriage-Pen")
rm(list=ls())
#This spreadsheet has all the income data and will show all the calculations, step-by-step.
income<-read.csv("income.csv", header = TRUE, fill = TRUE, sep = ",")
statetax<-read.csv("statetaxdata.csv", header = TRUE, fill = TRUE, sep = ",")
fedtax<-read.csv("fedtax.csv", header = TRUE, fill = TRUE, sep = ",")
data<-read.csv("data.csv", header = TRUE, fill = TRUE, sep = ",")
data2<-read.csv("newdata.csv", header = TRUE, fill = TRUE, sep = ",")
#Load Functions
source("Functions.R")
children<-0
output<-data2$income
taxburden1<-function(income1,children,married,hoh,stateincometax){
income<-income1
children<-children
if(children > 0){
hoh<-1
} else {
hoh<-0
}
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
taxburden2<-function(income2,children,married,hoh,stateincometax){
income<-income2
children<-0
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
marriedtaxburden<-function(income,children,married,hoh,stateincometax){
income<-income
married<-1
children<-1
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
x<-1
while(x <= length(data2$income)){
multiplier<-data2$multiplier[x]
i<-1
penalty<-NULL
while(i <= length(data2$income)){
income<-data2$income[i]
stateincometax<-0
married<-0
income1<-income*multiplier
income2<-income*(1-multiplier)
person1<-taxburden1(income1,children,married,hoh,stateincometax)
person2<-taxburden2(income2,children,married,hoh,stateincometax)
couple<-marriedtaxburden(income,children,married,hoh,stateincometax)
penalty[i]<-couple-(person1+person2)
i<-i+1
}
output<-cbind(output,penalty)
x<-x+1
}
#t(output)
write.table(output,sep=",",file="marriagepenalty.txt")
setwd("C:/Users/kep/Documents/GitHub/Marriage-Pen")
rm(list=ls())
#This spreadsheet has all the income data and will show all the calculations, step-by-step.
income<-read.csv("income.csv", header = TRUE, fill = TRUE, sep = ",")
statetax<-read.csv("statetaxdata.csv", header = TRUE, fill = TRUE, sep = ",")
fedtax<-read.csv("fedtax.csv", header = TRUE, fill = TRUE, sep = ",")
data<-read.csv("data.csv", header = TRUE, fill = TRUE, sep = ",")
data2<-read.csv("newdata.csv", header = TRUE, fill = TRUE, sep = ",")
#Load Functions
source("Functions.R")
children<-0
hoh<-0
output<-data2$income
taxburden1<-function(income1,children,married,hoh,stateincometax){
income<-income1
children<-children
if(children > 0){
hoh<-1
} else {
hoh<-0
}
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
taxburden2<-function(income2,children,married,hoh,stateincometax){
income<-income2
children<-0
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
marriedtaxburden<-function(income,children,married,hoh,stateincometax){
income<-income
married<-1
children<-1
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
x<-1
while(x <= length(data2$income)){
multiplier<-data2$multiplier[x]
i<-1
penalty<-NULL
while(i <= length(data2$income)){
income<-data2$income[i]
stateincometax<-0
married<-0
income1<-income*multiplier
income2<-income*(1-multiplier)
person1<-taxburden1(income1,children,married,hoh,stateincometax)
person2<-taxburden2(income2,children,married,hoh,stateincometax)
couple<-marriedtaxburden(income,children,married,hoh,stateincometax)
penalty[i]<-couple-(person1+person2)
i<-i+1
}
output<-cbind(output,penalty)
x<-x+1
}
View(output)
setwd("C:/Users/kep/Documents/GitHub/Marriage-Pen")
rm(list=ls())
#This spreadsheet has all the income data and will show all the calculations, step-by-step.
income<-read.csv("income.csv", header = TRUE, fill = TRUE, sep = ",")
statetax<-read.csv("statetaxdata.csv", header = TRUE, fill = TRUE, sep = ",")
fedtax<-read.csv("fedtax.csv", header = TRUE, fill = TRUE, sep = ",")
data<-read.csv("data.csv", header = TRUE, fill = TRUE, sep = ",")
data2<-read.csv("newdata.csv", header = TRUE, fill = TRUE, sep = ",")
#Load Functions
source("Functions.R")
children<-0
hoh<-0
output<-data2$income
taxburden1<-function(income1,children,married,hoh,stateincometax){
income<-income1
children<-children
if(children > 0){
hoh<-1
} else {
hoh<-0
}
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
taxburden2<-function(income2,children,married,hoh,stateincometax){
income<-income2
children<-0
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
marriedtaxburden<-function(income,children,married,hoh,stateincometax){
income<-income
married<-1
children<-1
taxableincome<-FedTaxableIncome(income,children, married, hoh, stateincometax)
incometax<-FedIncomeTax(taxableincome,married,hoh)
ctc<-FedCTC(income,children,married)
eitc<-FedEITC(income,children,married)
medicare<-MedSurtax(income,married)
totaltax<-(incometax+medicare)-(ctc+eitc)
return(totaltax)
}
x<-1
while(x <= length(data2$income)){
multiplier<-data2$multiplier[x]
i<-1
penalty<-NULL
while(i <= length(data2$income)){
income<-data2$income[i]
stateincometax<-0
married<-0
income1<-income*multiplier
income2<-income*(1-multiplier)
person1<-taxburden1(income1,children,married,hoh,stateincometax)
person2<-taxburden2(income2,children,married,hoh,stateincometax)
couple<-marriedtaxburden(income,children,married,hoh,stateincometax)
penalty[i]<-couple-(person1+person2)
i<-i+1
}
output<-cbind(output,penalty)
x<-x+1
}
View(output)
